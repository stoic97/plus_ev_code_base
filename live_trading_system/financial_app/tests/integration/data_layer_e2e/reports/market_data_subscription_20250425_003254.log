2025-04-25 00:32:54,501 - market_data_subscription_test - WARNING - Could not import real services: Using mock services as specified by environment variable
2025-04-25 00:32:54,501 - market_data_subscription_test - INFO - Falling back to mock implementations
2025-04-25 00:32:54,501 - market_data_subscription_test - INFO - === STARTING MARKET DATA SUBSCRIPTION TEST ===
2025-04-25 00:32:54,501 - market_data_subscription_test - INFO - Test ID: 20250425_003254
2025-04-25 00:32:54,501 - market_data_subscription_test - INFO - Using test instruments: [{'symbol': 'AAPL', 'exchange': 'NASDAQ'}, {'symbol': 'MSFT', 'exchange': 'NASDAQ'}, {'symbol': 'BTC/USD', 'exchange': 'COINBASE'}]
2025-04-25 00:32:54,501 - market_data_subscription_test - INFO - Service mode: MOCK
2025-04-25 00:32:54,501 - market_data_subscription_test - INFO - Starting market data subscription test with auth token: sample_auth_token
2025-04-25 00:32:54,501 - market_data_subscription_test - INFO - Initialized mock broker service with config: {'api_key': 'test_api_key', 'api_secret': 'test_api_secret', 'base_url': 'https://api.testbroker.com', 'timeout': 30}
2025-04-25 00:32:54,501 - market_data_subscription_test - INFO - Using mock service implementations
2025-04-25 00:32:54,501 - market_data_subscription_test - INFO - Setting up market data subscription test
2025-04-25 00:32:54,501 - market_data_subscription_test - INFO - [MOCK] Authenticating with broker using token: sample_auth_token
2025-04-25 00:32:55,001 - market_data_subscription_test - INFO - Successfully authenticated with broker
2025-04-25 00:32:55,001 - market_data_subscription_test - INFO - Subscribing to instruments: [{'symbol': 'AAPL', 'exchange': 'NASDAQ'}, {'symbol': 'MSFT', 'exchange': 'NASDAQ'}, {'symbol': 'BTC/USD', 'exchange': 'COINBASE'}]
2025-04-25 00:32:55,001 - market_data_subscription_test - INFO - [MOCK] Subscribing to market data for AAPL on NASDAQ
2025-04-25 00:32:55,001 - market_data_subscription_test - INFO - Subscription request sent for AAPL
2025-04-25 00:32:55,001 - market_data_subscription_test - INFO - [MOCK] Subscribing to market data for MSFT on NASDAQ
2025-04-25 00:32:55,005 - market_data_subscription_test - INFO - Subscription request sent for MSFT
2025-04-25 00:32:55,005 - market_data_subscription_test - INFO - [MOCK] Subscribing to market data for BTC/USD on COINBASE
2025-04-25 00:32:55,006 - market_data_subscription_test - INFO - Subscription request sent for BTC/USD
2025-04-25 00:32:55,006 - market_data_subscription_test - INFO - Verifying subscription acknowledgments with 20s timeout
2025-04-25 00:32:55,008 - market_data_subscription_test - INFO - [MOCK] Checking subscription status for ID: sub_AAPL_1745521375
2025-04-25 00:32:55,219 - market_data_subscription_test - INFO - Subscription confirmed for AAPL
2025-04-25 00:32:55,219 - market_data_subscription_test - INFO - [MOCK] Checking subscription status for ID: sub_MSFT_1745521375
2025-04-25 00:32:55,420 - market_data_subscription_test - INFO - Subscription confirmed for MSFT
2025-04-25 00:32:55,420 - market_data_subscription_test - INFO - [MOCK] Checking subscription status for ID: sub_BTC/USD_1745521375
2025-04-25 00:32:55,620 - market_data_subscription_test - INFO - Subscription confirmed for BTC/USD
2025-04-25 00:32:56,635 - market_data_subscription_test - INFO - All subscriptions confirmed
2025-04-25 00:32:56,635 - market_data_subscription_test - INFO - Confirming data flow with 60s timeout
2025-04-25 00:32:56,635 - market_data_subscription_test - INFO - Data received for AAPL: 2 messages
2025-04-25 00:32:56,635 - market_data_subscription_test - INFO - Data received for MSFT: 2 messages
2025-04-25 00:32:56,635 - market_data_subscription_test - INFO - Data received for BTC/USD: 2 messages
2025-04-25 00:32:56,635 - market_data_subscription_test - INFO - Testing subscription management (add/remove)
2025-04-25 00:32:56,635 - market_data_subscription_test - INFO - Unsubscribing from AAPL
2025-04-25 00:32:56,635 - market_data_subscription_test - INFO - [MOCK] Unsubscribing from market data for subscription ID: sub_AAPL_1745521375
2025-04-25 00:33:03,951 - market_data_subscription_test - INFO - Successfully unsubscribed from AAPL
2025-04-25 00:33:03,951 - market_data_subscription_test - INFO - Resubscribing to AAPL
2025-04-25 00:33:03,951 - market_data_subscription_test - INFO - [MOCK] Subscribing to market data for AAPL on NASDAQ
2025-04-25 00:33:05,958 - market_data_subscription_test - INFO - [MOCK] Checking subscription status for ID: sub_AAPL_1745521383
2025-04-25 00:33:06,173 - market_data_subscription_test - INFO - Successfully resubscribed to AAPL
2025-04-25 00:33:06,483 - market_data_subscription_test - INFO - Data flowing again for AAPL after resubscription
2025-04-25 00:33:06,483 - market_data_subscription_test - INFO - Market data subscription test passed successfully
2025-04-25 00:33:06,483 - market_data_subscription_test - INFO - Tearing down market data subscription test
2025-04-25 00:33:06,483 - market_data_subscription_test - INFO - [MOCK] Unsubscribing from market data for subscription ID: sub_AAPL_1745521383
2025-04-25 00:33:06,798 - market_data_subscription_test - INFO - Unsubscribed from AAPL
2025-04-25 00:33:06,798 - market_data_subscription_test - INFO - [MOCK] Unsubscribing from market data for subscription ID: sub_MSFT_1745521375
2025-04-25 00:33:07,113 - market_data_subscription_test - INFO - Unsubscribed from MSFT
2025-04-25 00:33:07,113 - market_data_subscription_test - INFO - [MOCK] Unsubscribing from market data for subscription ID: sub_BTC/USD_1745521375
2025-04-25 00:33:07,414 - market_data_subscription_test - INFO - Unsubscribed from BTC/USD
2025-04-25 00:33:07,414 - market_data_subscription_test - INFO - [MOCK] Closing broker connection
2025-04-25 00:33:07,414 - market_data_subscription_test - INFO - Broker connection closed
2025-04-25 00:33:07,414 - market_data_subscription_test - INFO - TEST RESULT: Market Data Subscription Test - PASSED
2025-04-25 00:33:07,414 - market_data_subscription_test - INFO - === MARKET DATA SUBSCRIPTION TEST COMPLETED: PASSED ===
